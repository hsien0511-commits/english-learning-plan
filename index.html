<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>12é€±è‹±èªæŒ‘æˆ°ï¼šé€²éšç¾åŒ–ç‰ˆ</title>
    <style>
        :root {
            --bg: #0f1114; --sidebar: #16181d; --card: rgba(30, 34, 42, 0.7);
            --accent: #64b5f6; --accent-glow: rgba(100, 181, 246, 0.3);
            --text: #e0e0e0; --dim: #94a3b8; --success: #81c784;
            --danger: #ff5252; --border: rgba(255, 255, 255, 0.08);
        }
        body { font-family: 'Inter', 'PingFang TC', sans-serif; background: var(--bg); color: var(--text); display: flex; margin: 0; height: 100vh; overflow: hidden; }
        .sidebar { width: 320px; background: var(--sidebar); border-right: 1px solid var(--border); display: flex; flex-direction: column; }
        .sidebar-header { padding: 25px; border-bottom: 1px solid var(--border); }
        .progress-box { background: #1e222a; padding: 18px; border-radius: 12px; margin-top: 15px; border: 1px solid var(--border); }
        .progress-bar-bg { background: #334155; height: 8px; border-radius: 4px; overflow: hidden; position: relative; }
        .progress-bar-fill { background: linear-gradient(90deg, #42a5f5, #90caf9); height: 100%; transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1); position: relative; }
        .progress-bar-fill::after { content: ''; position: absolute; top: 0; left: -100%; width: 50%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); animation: shine 3s infinite; }
        @keyframes shine { to { left: 150%; } }
        .menu-list { flex-grow: 1; overflow-y: auto; }
        .week-title { padding: 15px 20px; background: rgba(255,255,255,0.03); font-size: 0.8em; letter-spacing: 1px; color: var(--dim); }
        .day-item { padding: 14px 25px; font-size: 0.9em; cursor: pointer; transition: 0.3s; display: flex; justify-content: space-between; border-bottom: 1px solid rgba(255,255,255,0.02); }
        .day-item.active { background: rgba(100, 181, 246, 0.1); color: var(--accent); border-left: 4px solid var(--accent); }
        .status-dot { width: 8px; height: 8px; border-radius: 50%; background: #444; align-self: center; }
        .status-dot.done { background: var(--success); }
        .main { flex-grow: 1; overflow-y: auto; padding: 40px; }
        .container { max-width: 850px; margin: 0 auto; }
        .video-box { width: 100%; aspect-ratio: 16/9; background: #000; border-radius: 12px; overflow: hidden; margin-bottom: 30px; border: 1px solid var(--border); }
        .task-card { background: var(--card); backdrop-filter: blur(12px); border-radius: 16px; padding: 25px; margin-bottom: 25px; border: 1px solid var(--border); box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .sentence-text { font-size: 1.3em; color: var(--accent); margin: 15px 0; font-weight: 500; text-shadow: 0 0 10px var(--accent-glow); }
        button { border: none; padding: 10px 20px; border-radius: 10px; cursor: pointer; font-weight: 600; transition: 0.2s; }
        .btn-play { background: #334155; color: white; margin-right: 10px; }
        .btn-rec { background: var(--accent); color: #0f1114; }
        .btn-rec.recording { background: var(--danger); color: white; animation: pulse-red 1.5s infinite; }
        @keyframes pulse-red { 0% { box-shadow: 0 0 0 0 rgba(239, 83, 80, 0.7); } 70% { box-shadow: 0 0 0 15px rgba(239, 83, 80, 0); } 100% { box-shadow: 0 0 0 0 rgba(239, 83, 80, 0); } }
        .audio-item { background: rgba(255, 255, 255, 0.03); padding: 20px; border-radius: 14px; margin-bottom: 15px; border: 1px solid var(--border); display: flex; flex-direction: column; gap: 10px; }
        audio { height: 35px; width: 100%; filter: invert(90%) hue-rotate(180deg) brightness(1.2); }
        .btn-delete { background: transparent; color: var(--dim); align-self: flex-end; }
        .vocab-list { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 10px; }
        .vocab-item { background: rgba(255,255,255,0.05); padding: 4px 12px; border-radius: 15px; font-size: 0.85em; display: flex; align-items: center; gap: 5px; }
    </style>
</head>
<body>
<div class="sidebar">
    <div class="sidebar-header">
        <h3 style="margin:0">English Learning</h3>
        <div class="progress-box">
            <div id="progress-text" class="progress-text">è¼‰å…¥ä¸­...</div>
            <div class="progress-bar-bg"><div id="progress-fill" class="progress-bar-fill" style="width:0%"></div></div>
        </div>
    </div>
    <div id="menu" class="menu-list"></div>
</div>
<div class="main">
    <div id="content" style="display:none" class="container">
        <h2 id="day-label" style="margin:0; color:var(--accent)"></h2>
        <h1 id="day-topic" style="margin: 10px 0 20px 0"></h1>
        <div class="video-box"><div id="player"></div></div>
        <div id="tasks-container"></div>
        <div class="history-box">
            <h3>ğŸ“œ æ­·å²è©•åˆ†èˆ‡éŸ³æª”</h3>
            <div id="history-list"></div>
        </div>
    </div>
</div>
<script>
    let player, db, isRecording = false;
    const Recognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const planData = [
        {
            week: "ç¬¬ä¸€å€‹æœˆï¼šè‡ªç„¶ç•Œè§€å¯Ÿè€…",
            days: [
                { id: "w1d1", label: "W1D1", topic: "ç”Ÿå‘½æ˜¯ä»€éº¼ï¼Ÿ", vid: "Gy60BqCnTG4", start: 0, tasks: [{ sentence: "Living things need to breathe.", vocab: ["Living", "Breathe"] }, { sentence: "A rock cannot grow.", vocab: ["Rock", "Grow"] }, { sentence: "All living things change over time.", vocab: ["Change", "Energy"] }] },
                { id: "w1d2", label: "W1D2", topic: "æ¤ç‰©çš„æˆé•·", vid: "tkFPyue5X3Q", start: 30, tasks: [{ sentence: "Seeds grow roots first.", vocab: ["Seed", "Root"] }, { sentence: "The stem helps the plant stand up.", vocab: ["Stem", "Stand"] }, { sentence: "Leaves need sunlight to make food.", vocab: ["Leaf", "Sunlight"] }] },
                { id: "w1d3", label: "W1D3", topic: "è½è‘‰çš„é¡è‰²", vid: "Xk4-6II8l5Q", start: 60, tasks: [{ sentence: "Chlorophyll makes leaves green.", vocab: ["Autumn", "Chlorophyll"] }, { sentence: "Trees rest during the winter.", vocab: ["Green", "Rest"] }, { sentence: "Leaves turn red and orange in autumn.", vocab: ["Sugar", "Autumn"] }] },
                { id: "w1d4", label: "W1D4", topic: "åœŸå£¤çš„ç§˜å¯†", vid: "Q-J2FErZHuA", start: 45, tasks: [{ sentence: "Soil is full of nutrients.", vocab: ["Soil", "Nutrient"] }, { sentence: "Worms help keep the soil healthy.", vocab: ["Worm", "Healthy"] }, { sentence: "Plants need good soil to grow.", vocab: ["Garden", "Grow"] }] },
                { id: "w1d5", label: "W1D5", topic: "é£ŸèŸ²æ¤ç‰©", vid: "6L_p3ZkSlLo", start: 75, tasks: [{ sentence: "Some plants eat insects.", vocab: ["Carnivorous", "Trap"] }, { sentence: "The trap is very sticky.", vocab: ["Insect", "Sticky"] }, { sentence: "The plant digests the fly.", vocab: ["Digest", "Fly"] }] },
                { id: "w2d1", label: "W2D1", topic: "è—é¯¨å¥‡è§€", vid: "dciLg3Zm1hI", start: 0, tasks: [{ sentence: "The blue whale is the biggest mammal.", vocab: ["Mammal", "Ocean"] }, { sentence: "Its heart is as big as a car.", vocab: ["Giant", "Heart"] }, { sentence: "It breathes through a blowhole.", vocab: ["Blowhole", "Breathe"] }] },
                { id: "w2d2", label: "W2D2", topic: "ä¼éµå®¶æ—", vid: "T8Wp2yWH_3E", start: 40, tasks: [{ sentence: "Penguins live in the cold Antarctica.", vocab: ["Antarctica", "Feather"] }, { sentence: "They use feathers to stay warm.", vocab: ["Slide", "Warm"] }, { sentence: "They dive deep into the ocean.", vocab: ["Dive", "Group"] }] },
                { id: "w2d3", label: "W2D3", topic: "æµ·æ´‹åˆ†å±¤", vid: "fHVE4B-UjmM", start: 60, tasks: [{ sentence: "The top zone has the most sunlight.", vocab: ["Sunlight", "Twilight"] }, { sentence: "Many strange fish live in the dark.", vocab: ["Deep", "Dark"] }, { sentence: "Water pressure is high in the deep sea.", vocab: ["Pressure", "Sea"] }] },
                { id: "w2d4", label: "W2D4", topic: "è°æ˜æµ·è±š", vid: "hREPV58WNp0", start: 30, tasks: [{ sentence: "Dolphins are very intelligent animals.", vocab: ["Intelligent", "Pod"] }, { sentence: "They live together in a pod.", vocab: ["Sound", "Jump"] }, { sentence: "They use sounds to talk to each other.", vocab: ["Friendly", "Talk"] }] },
                { id: "w2d5", label: "W2D5", topic: "å¥‡æ€ªæ·±æµ·é­š", vid: "A7LU5Wxc_0Y", start: 60, tasks: [{ sentence: "The blobfish looks very strange.", vocab: ["Blobfish", "Strange"] }, { sentence: "It lives deep under the ocean.", vocab: ["Appearance", "Deep"] }, { sentence: "It floats above the sea floor.", vocab: ["Float", "Floor"] }] },
                { id: "w3d1", label: "W3D1", topic: "è´è¶è›»è®Š", vid: "V5RSpMQQOpw", start: 60, tasks: [{ sentence: "The caterpillar makes a chrysalis.", vocab: ["Caterpillar", "Chrysalis"] }, { sentence: "It changes into a butterfly.", vocab: ["Butterfly", "Change"] }, { sentence: "Its wings are very beautiful.", vocab: ["Wings", "Beautiful"] }] },
                { id: "w3d2", label: "W3D2", topic: "å¿™ç¢Œèœœèœ‚", vid: "ta154f5Rp5Y", start: 30, tasks: [{ sentence: "Bees collect pollen from flowers.", vocab: ["Pollen", "Nectar"] }, { sentence: "They bring nectar back to the hive.", vocab: ["Hive", "Honey"] }, { sentence: "The queen bee is very important.", vocab: ["Queen", "Important"] }] },
                { id: "w3d3", label: "W3D3", topic: "èœ˜è››æœ‹å‹", vid: "3qdxEiIB_Sw", start: 90, tasks: [{ sentence: "Spiders use silk to make webs.", vocab: ["Spider", "Web"] }, { sentence: "They have eight legs.", vocab: ["Silk", "Eight"] }, { sentence: "Most spiders are not dangerous to us.", vocab: ["Predator", "Safe"] }] },
                { id: "w3d4", label: "W3D4", topic: "èèŸ»å¸åœ‹", vid: "dTmlE9Cduj4", start: 0, tasks: [{ sentence: "Ants live together in a colony.", vocab: ["Colony", "Tunnel"] }, { sentence: "They dig tunnels under the ground.", vocab: ["Worker", "Ground"] }, { sentence: "Ants can carry very heavy things.", vocab: ["Strong", "Carry"] }] },
                { id: "w3d5", label: "W3D5", topic: "è¢ç«èŸ²ä¹‹å…‰", vid: "Y7RI1qjB2r8", start: 60, tasks: [{ sentence: "Fireflies flash their lights at night.", vocab: ["Flash", "Light"] }, { sentence: "They use light to talk to friends.", vocab: ["Signal", "Night"] }, { sentence: "The light comes from their tails.", vocab: ["Tail", "Friend"] }] },
                { id: "w4d1", label: "W4D1", topic: "æ£®æ—å¤§è²“", vid: "8cQmky_wQao", start: 45, tasks: [{ sentence: "Lions are called the king of beasts.", vocab: ["Lion", "King"] }, { sentence: "Tigers have stripes on their fur.", vocab: ["Tiger", "Fur"] }, { sentence: "Big cats are powerful predators.", vocab: ["Predator", "Roar"] }] },
                { id: "w4d2", label: "W4D2", topic: "çŒ©çŒ©ç”Ÿæ´»", vid: "rHhSCO5-3Pg", start: 0, tasks: [{ sentence: "Gorillas live in the deep forest.", vocab: ["Gorilla", "Forest"] }, { sentence: "They live in a group called a troop.", vocab: ["Social", "Troop"] }, { sentence: "They are very gentle giants.", vocab: ["Gentle", "Giant"] }] },
                { id: "w4d3", label: "W4D3", topic: "ç„¡å°¾ç†Šæ•£ç†±", vid: "JnZTNWbQsKQ", start: 30, tasks: [{ sentence: "Koalas live in Australia.", vocab: ["Koala", "Australia"] }, { sentence: "They hug trees to stay cool.", vocab: ["Cool", "Hug"] }, { sentence: "They love to eat eucalyptus leaves.", vocab: ["Eucalyptus", "Leaf"] }] },
                { id: "w4d4", label: "W4D4", topic: "æ¨¹æ‡¶å¥§ç§˜", vid: "eq42qcpTo1o", start: 75, tasks: [{ sentence: "Sloths are the slowest mammals.", vocab: ["Sloth", "Slow"] }, { sentence: "They spend most time on branches.", vocab: ["Jungle", "Branch"] }, { sentence: "They sleep for a long time.", vocab: ["Sleep", "Time"] }] },
                { id: "w4d5", label: "W4D5", topic: "è°æ˜çƒé´‰", vid: "XofnexWvBN0", start: 45, tasks: [{ sentence: "Crows are very clever birds.", vocab: ["Crow", "Clever"] }, { sentence: "They can use tools to get food.", vocab: ["Tool", "Food"] }, { sentence: "They are good at solving problems.", vocab: ["Problem", "Brain"] }] }
            ]
        },
        {
            week: "ç¬¬äºŒå€‹æœˆï¼šäººé«”èˆ‡åœ°çƒçš„å¥§ç§˜",
            days: [
                { id: "w5d1", label: "W5D1", topic: "éª¨éª¼ç³»çµ±", vid: "B3Fv2X8EKfE", start: 60, tasks: [{ sentence: "Bones protect our brain and heart.", vocab: ["Bone", "Skeleton"] }, { sentence: "Your skeleton is like a strong frame.", vocab: ["Protect", "Frame"] }, { sentence: "Adults have two hundred and six bones.", vocab: ["Skull", "Adult"] }] },
                { id: "w5d2", label: "W5D2", topic: "è‚Œè‚‰èˆ‡é‹å‹•", vid: "j918PoWWaB0", start: 30, tasks: [{ sentence: "Muscles pull on bones to move.", vocab: ["Muscle", "Move"] }, { sentence: "We have many muscles in our body.", vocab: ["Pull", "Body"] }, { sentence: "Exercise makes your muscles strong.", vocab: ["Strong", "Exercise"] }] },
                { id: "w5d3", label: "W5D3", topic: "ç¥å¥‡å¤§è…¦", vid: "V5RSpMQQOpw", start: 60, tasks: [{ sentence: "The brain controls everything we do.", vocab: ["Brain", "Think"] }, { sentence: "It sends messages to our body.", vocab: ["Message", "Control"] }, { sentence: "Our brain helps us to remember things.", vocab: ["Memory", "Remember"] }] },
                { id: "w5d4", label: "W5D4", topic: "å¿ƒè‡Ÿè·³å‹•", vid: "fN1Cyr0ZK9M", start: 45, tasks: [{ sentence: "The heart pumps blood everywhere.", vocab: ["Heart", "Pump"] }, { sentence: "You can feel your heart beat.", vocab: ["Blood", "Beat"] }, { sentence: "Blood carries oxygen to your cells.", vocab: ["Oxygen", "Cell"] }] },
                { id: "w5d5", label: "W5D5", topic: "äº”ç¨®æ„Ÿå®˜", vid: "XtSq1wcFSEI", start: 120, tasks: [{ sentence: "We use our eyes for sight.", vocab: ["Sight", "Hearing"] }, { sentence: "Our ears help us with hearing.", vocab: ["Touch", "Smell"] }, { sentence: "The tongue is the organ for taste.", vocab: ["Taste", "Organ"] }] },
                { id: "w6d1", label: "W6D1", topic: "æ¶ˆåŒ–éç¨‹", vid: "B3Fv2X8EKfE", start: 90, tasks: [{ sentence: "Food gives our body energy.", vocab: ["Stomach", "Energy"] }, { sentence: "We swallow food to the stomach.", vocab: ["Food", "Swallow"] }, { sentence: "The intestine absorbs nutrients.", vocab: ["Intestine", "Nutrient"] }] },
                { id: "w6d2", label: "W6D2", topic: "ç‚ºä»€éº¼è¦çœ¨çœ¼", vid: "V5RSpMQQOpw", start: 30, tasks: [{ sentence: "Blinking keeps our eyes wet.", vocab: ["Blink", "Eyelid"] }, { sentence: "We blink to keep out the dust.", vocab: ["Dust", "Wet"] }, { sentence: "It is a very quick movement.", vocab: ["Protect", "Quick"] }] },
                { id: "w6d3", label: "W6D3", topic: "ç‰™é½’çš„ä½œç”¨", vid: "TG3fyVOWqJY", start: 60, tasks: [{ sentence: "We use teeth to chew food.", vocab: ["Enamel", "Chew"] }, { sentence: "Enamel is the hardest part.", vocab: ["Bite", "Hardest"] }, { sentence: "Brush your teeth to keep them healthy.", vocab: ["Dentist", "Healthy"] }] },
                { id: "w6d4", label: "W6D4", topic: "ç‚ºä»€éº¼æœƒæ„Ÿå†’", vid: "V5RSpMQQOpw", start: 75, tasks: [{ sentence: "Germs can make us feel sick.", vocab: ["Germ", "Virus"] }, { sentence: "Wash your hands with soap.", vocab: ["Sneeze", "Wash"] }, { sentence: "Cover your mouth when you sneeze.", vocab: ["Soap", "Mouth"] }] },
                { id: "w6d5", label: "W6D5", topic: "ç¡çœ çš„é‡è¦æ€§", vid: "gqQ-XQ7P704", start: 45, tasks: [{ sentence: "Our body needs sleep to rest.", vocab: ["Sleep", "Rest"] }, { sentence: "Kids need more sleep than adults.", vocab: ["Dream", "Energy"] }, { sentence: "Dreaming happens when we are asleep.", vocab: ["Night", "Asleep"] }] },
                { id: "w7d1", label: "W7D1", topic: "ç«å±±çˆ†ç™¼", vid: "TuY1NhrKIeM", start: 60, tasks: [{ sentence: "Magma is hot rock inside the Earth.", vocab: ["Volcano", "Magma"] }, { sentence: "When it comes out, it is called lava.", vocab: ["Lava", "Erupt"] }, { sentence: "Volcanoes can erupt with ash and fire.", vocab: ["Ash", "Fire"] }] },
                { id: "w7d2", label: "W7D2", topic: "æ°´å¾ªç’°", vid: "fN1Cyr0ZK9M", start: 30, tasks: [{ sentence: "Water evaporates into the air.", vocab: ["Cycle", "Evaporate"] }, { sentence: "It forms clouds in the sky.", vocab: ["Cloud", "Rain"] }, { sentence: "Rain brings water back to the ground.", vocab: ["Water", "Ground"] }] },
                { id: "w7d3", label: "W7D3", topic: "é›·é³´èˆ‡é–ƒé›»", vid: "tDoOiwNcawk", start: 60, tasks: [{ sentence: "Lightning is a flash of electricity.", vocab: ["Thunder", "Lightning"] }, { sentence: "Thunder is the sound of lightning.", vocab: ["Storm", "Electricity"] }, { sentence: "Storms can be very loud.", vocab: ["Flash", "Loud"] }] },
                { id: "w7d4", label: "W7D4", topic: "é¾æ²é¢¨", vid: "-s3UwOq1P1E", start: 75, tasks: [{ sentence: "A tornado is a spinning wind.", vocab: ["Tornado", "Wind"] }, { sentence: "It is a very powerful storm.", vocab: ["Spin", "Storm"] }, { sentence: "Stay in a safe place during a tornado.", vocab: ["Safety", "Powerful"] }] },
                { id: "w7d5", label: "W7D5", topic: "å­£ç¯€çš„æˆå› ", vid: "UQjT5uKp2hg", start: 45, tasks: [{ sentence: "Earth tilts as it orbits the Sun.", vocab: ["Season", "Orbit"] }, { sentence: "Tilt causes different seasons.", vocab: ["Tilt", "Summer"] }, { sentence: "Summer is hot and winter is cold.", vocab: ["Winter", "Cold"] }] },
                { id: "w8d1", label: "W8D1", topic: "åœ°çƒçš„èµ·æº", vid: "fJ0J4mbj0_o", start: 60, tasks: [{ sentence: "Earth was born from dust and gas.", vocab: ["Planet", "Space"] }, { sentence: "Gravity pulled everything together.", vocab: ["Dust", "Gravity"] }, { sentence: "It took a long time to form.", vocab: ["Birth", "Form"] }] },
                { id: "w8d2", label: "W8D2", topic: "èªè­˜å²©çŸ³", vid: "TuY1NhrKIeM", start: 120, tasks: [{ sentence: "There are three main types of rocks.", vocab: ["Rock", "Igneous"] }, { sentence: "Igneous rocks come from volcanoes.", vocab: ["Sedimentary", "Metamorphic"] }, { sentence: "Rocks change over millions of years.", vocab: ["Hard", "Change"] }] },
                { id: "w8d3", label: "W8D3", topic: "åœ°å€ç”Ÿç‰©å¤šæ¨£æ€§", vid: "Q-J2FEZHuA", start: 150, tasks: [{ sentence: "Animals live in different habitats.", vocab: ["Habitat", "Diverse"] }, { sentence: "Biodiversity means many kinds of life.", vocab: ["Species", "Nature"] }, { sentence: "We must protect our environment.", vocab: ["Environment", "Life"] }] },
                { id: "w8d4", label: "W8D4", topic: "æ£®æ—çš„é‡è¦æ€§", vid: "Gy60BqCnTG4", start: 30, tasks: [{ sentence: "Forests give us clean air.", vocab: ["Forest", "Tree"] }, { sentence: "Many animals live in the trees.", vocab: ["Oxygen", "Animal"] }, { sentence: "Trees are a natural resource.", vocab: ["Natural", "Resource"] }] },
                { id: "w8d5", label: "W8D5", topic: "å±±è„ˆå¦‚ä½•å½¢æˆ", vid: "Fd_XqYE2BWY", start: 60, tasks: [{ sentence: "Tectonic plates move very slowly.", vocab: ["Mountain", "Plate"] }, { sentence: "They push against each other.", vocab: ["Tectonic", "Push"] }, { sentence: "This movement creates high mountains.", vocab: ["High", "Move"] }] }
            ]
        },
        {
            week: "ç¬¬ä¸‰å€‹æœˆï¼šå¤ªç©ºã€ç‰©ç†èˆ‡ç™¼æ˜",
            days: [
                { id: "w9d1", label: "W9D1", topic: "å¤ªé™½ï¼šæˆ‘å€‘çš„æ†æ˜Ÿ", vid: "w36yxLgwUOc", start: 60, tasks: [{ sentence: "The Sun is at the center.", vocab: ["Center", "Orbit"] }, { sentence: "All planets orbit around the Sun.", vocab: ["Energy", "Heat"] }, { sentence: "Gravity keeps everything in place.", vocab: ["Gravity", "Place"] }] },
                { id: "w9d2", label: "W9D2", topic: "å…§è¡Œæ˜Ÿï¼ˆå²©çŸ³ï¼‰", vid: "mRzasmJ_RmU", start: 30, tasks: [{ sentence: "Four inner planets have rocky surfaces.", vocab: ["Mercury", "Venus"] }, { sentence: "Mercury is the closest to the Sun.", vocab: ["Earth", "Mars"] }, { sentence: "Mars is known as the Red Planet.", vocab: ["Surface", "Planet"] }] },
                { id: "w9d3", label: "W9D3", topic: "å¤–è¡Œæ˜Ÿï¼ˆæ°£é«”ï¼‰", vid: "mRzasmJ_RmU", start: 120, tasks: [{ sentence: "The outer planets are made of gas.", vocab: ["Jupiter", "Saturn"] }, { sentence: "Jupiter is the largest planet.", vocab: ["Uranus", "Neptune"] }, { sentence: "Saturn is famous for its rings.", vocab: ["Gas", "Ring"] }] },
                { id: "w9d4", label: "W9D4", topic: "æœˆäº®çš„ç›¸ä½", vid: "ZjOmLfE-O6I", start: 180, tasks: [{ sentence: "The Moon reflects light from the Sun.", vocab: ["Reflection", "Cycle"] }, { sentence: "It takes a month to orbit Earth.", vocab: ["Full Moon", "Crescent"] }, { sentence: "The Moon's shape appears to change.", vocab: ["Orbit", "Change"] }] },
                { id: "w9d5", label: "W9D5", topic: "æˆ‘å€‘èƒ½ä½ç«æ˜Ÿå—", vid: "V5RSpMQQOpw", start: 60, tasks: [{ sentence: "Scientists want to send humans to Mars.", vocab: ["Spacecraft", "Astronaut"] }, { sentence: "The journey takes a long time.", vocab: ["Planet", "Cold"] }, { sentence: "It is a very cold and dry planet.", vocab: ["Journey", "Dry"] }] },
                { id: "w10d1", label: "W10D1", topic: "ä»€éº¼æ˜¯è¬æœ‰å¼•åŠ›", vid: "fN1Cyr0ZK9M", start: 45, tasks: [{ sentence: "Gravity is a force that pulls things.", vocab: ["Gravity", "Force"] }, { sentence: "It keeps us on the ground.", vocab: ["Pull", "Ground"] }, { sentence: "Isaac Newton discovered gravity.", vocab: ["Newton", "Discover"] }] },
                { id: "w10d2", label: "W10D2", topic: "å½±å­æ€éº¼å½¢æˆ", vid: "fN1Cyr0ZK9M", start: 30, tasks: [{ sentence: "A shadow forms when light is blocked.", vocab: ["Shadow", "Light"] }, { sentence: "The shape changes with the light.", vocab: ["Block", "Shape"] }, { sentence: "Shadows are long in the morning.", vocab: ["Sun", "Long"] }] },
                { id: "w10d3", label: "W10D3", topic: "ç°¡å–®æ©Ÿæ¢°ï¼šæ§“æ¡¿", vid: "tk9iUjMEnaY", start: 90, tasks: [{ sentence: "A lever helps us lift heavy things.", vocab: ["Lever", "Force"] }, { sentence: "It is a simple machine.", vocab: ["Lift", "Tool"] }, { sentence: "You can see levers in a playground.", vocab: ["Simple", "Playground"] }] },
                { id: "w10d4", label: "W10D4", topic: "æ»‘è¼ªçš„ä½œç”¨", vid: "tk9iUjMEnaY", start: 240, tasks: [{ sentence: "A pulley uses a rope and a wheel.", vocab: ["Pulley", "Rope"] }, { sentence: "It helps to raise heavy weights.", vocab: ["Wheel", "Raise"] }, { sentence: "Pulleys are used on sailboats.", vocab: ["Weight", "Sailboat"] }] },
                { id: "w10d5", label: "W10D5", topic: "ç£éµçš„é­”åŠ›", vid: "fN1Cyr0ZK9M", start: 60, tasks: [{ sentence: "Magnets can pull certain metals.", vocab: ["Magnet", "Pull"] }, { sentence: "They have north and south poles.", vocab: ["Metal", "North"] }, { sentence: "Like poles push each other away.", vocab: ["South", "Push"] }] },
                { id: "w11d1", label: "W11D1", topic: "å·§å…‹åŠ›ç™¼æ˜å²", vid: "Yr88rbWb-7E", start: 5, tasks: [{ sentence: "Chocolate comes from cacao beans.", vocab: ["Chocolate", "Invention"] }, { sentence: "It was once a bitter drink.", vocab: ["Bean", "Tasty"] }, { sentence: "Now it is a tasty treat for all.", vocab: ["History", "Treat"] }] },
                { id: "w11d2", label: "W11D2", topic: "æ´‹èŠ‹ç‰‡çš„æ•…äº‹", vid: "Yr88rbWb-7E", start: 292, tasks: [{ sentence: "A chef invented chips by accident.", vocab: ["Potato", "Snack"] }, { sentence: "They are thin, salty and crisp.", vocab: ["Invention", "Salty"] }, { sentence: "It is a very popular snack.", vocab: ["Crisp", "Popular"] }] },
                { id: "w11d3", label: "W11D3", topic: "å¾®æ³¢çˆåŸç†", vid: "Yr88rbWb-7E", start: 798, tasks: [{ sentence: "Microwaves heat food very fast.", vocab: ["Microwave", "Heat"] }, { sentence: "It was discovered by a scientist.", vocab: ["Invention", "Fast"] }, { sentence: "Most kitchens have one today.", vocab: ["Kitchen", "Scientist"] }] },
                { id: "w11d4", label: "W11D4", topic: "ä¾¿åˆ©è²¼ç™¼æ˜", vid: "nMkW5JXyclg", start: 30, tasks: [{ sentence: "Glue on the note is not too strong.", vocab: ["Sticky", "Note"] }, { sentence: "You can stick it and pull it off.", vocab: ["Glue", "Invention"] }, { sentence: "It is useful for making notes.", vocab: ["Office", "Useful"] }] },
                { id: "w11d5", label: "W11D5", topic: "é›»è…¦å¦‚ä½•é‹ä½œ", vid: "V5RSpMQQOpw", start: 60, tasks: [{ sentence: "Computers process a lot of data.", vocab: ["Computer", "Data"] }, { sentence: "They use a code called binary.", vocab: ["Screen", "Code"] }, { sentence: "We use them to go on the Internet.", vocab: ["Internet", "Binary"] }] },
                { id: "w12d1", label: "W12D1", topic: "è‡ªç„¶è³‡æº", vid: "ajk-pvm5vfQ", start: 60, tasks: [{ sentence: "Nature gives us many resources.", vocab: ["Natural", "Resource"] }, { sentence: "Water and sun are natural resources.", vocab: ["Water", "Energy"] }, { sentence: "We should save our resources.", vocab: ["Save", "Earth"] }] },
                { id: "w12d2", label: "W12D2", topic: "å†ç”Ÿèƒ½æº", vid: "ajk-pvm5vfQ", start: 180, tasks: [{ sentence: "Solar energy comes from the Sun.", vocab: ["Renewable", "Wind"] }, { sentence: "Wind power is a clean energy.", vocab: ["Solar", "Clean"] }, { sentence: "Renewable means it never runs out.", vocab: ["Earth", "Energy"] }] },
                { id: "w12d3", label: "W12D3", topic: "æ¸›å°‘æ±¡æŸ“", vid: "MQLadfsvfLo", start: 90, tasks: [{ sentence: "Plastic trash can hurt the ocean.", vocab: ["Pollution", "Trash"] }, { sentence: "We need to reduce our pollution.", vocab: ["Plastic", "Earth"] }, { sentence: "Take care of our beautiful Earth.", vocab: ["Care", "Ocean"] }] },
                { id: "w12d4", label: "W12D4", topic: "æœªä¾†çš„ç™¼æ˜", vid: "V5RSpMQQOpw", start: 60, tasks: [{ sentence: "Robots will help us in the future.", vocab: ["Future", "Robot"] }, { sentence: "Science helps us to dream big.", vocab: ["Space", "Science"] }, { sentence: "New inventions change our life.", vocab: ["Dream", "Invention"] }] },
                { id: "w12d5", label: "W12D5", topic: "ç¸½è¤‡ç¿’èˆ‡æˆå°±", vid: "Gy60BqCnTG4", start: 0, tasks: [{ sentence: "I finished my twelve-week plan.", vocab: ["Review", "Master"] }, { sentence: "I learned many new English words.", vocab: ["Progress", "Goal"] }, { sentence: "My English is getting much better.", vocab: ["English", "Better"] }] }
            ]
        }
    ];

    function renderSidebar() {
        const menu = document.getElementById('menu');
        const history = JSON.parse(localStorage.getItem('study_done') || '[]');
        menu.innerHTML = '';
        planData.forEach(w => {
            const wt = document.createElement('div'); wt.className = 'week-title'; wt.innerText = w.week; menu.appendChild(wt);
            w.days.forEach(d => {
                const di = document.createElement('div'); di.className = `day-item ${history.includes(d.id) ? 'active' : ''}`;
                di.innerHTML = `<span>${d.label} ${d.topic}</span><div class="status-dot ${history.includes(d.id)?'done':''}"></div>`;
                di.onclick = () => loadDay(d); menu.appendChild(di);
            });
        });
        const totalDays = 60; const percent = Math.min(Math.round((history.length / totalDays) * 100), 100);
        document.getElementById('progress-text').innerText = `å·²å®Œæˆ ${history.length} å¤© / ${totalDays} å¤© (${percent}%)`;
        document.getElementById('progress-fill').style.width = percent + '%';
    }

    function loadDay(day) {
        document.getElementById('content').style.display = 'block';
        document.getElementById('day-label').innerText = day.label;
        document.getElementById('day-topic').innerText = day.topic;
        const container = document.getElementById('tasks-container');
        container.innerHTML = '';
        day.tasks.forEach(task => {
            const card = document.createElement('div'); card.className = 'task-card';
            card.innerHTML = `
                <div class="vocab-list">${task.vocab.map(v => `<div class="vocab-item"><span>${v}</span><button class="btn-play" onclick="speak('${v}')">ğŸ”Š</button><button class="btn-rec" onclick="startChallenge(this, '${v}')">ğŸ¤</button></div>`).join('')}</div>
                <div class="sentence-text">"${task.sentence}"</div>
                <div class="btn-group"><button class="btn-play" onclick="speak('${task.sentence}')">ğŸ”Š è†è½å¥å­</button><button class="btn-rec" onclick="startChallenge(this, '${task.sentence}')">ğŸ¤ éŒ„éŸ³è©•åˆ†</button></div>
            `;
            container.appendChild(card);
        });
        if (player && player.loadVideoById) player.loadVideoById({ videoId: day.vid, startSeconds: day.start });
        let done = JSON.parse(localStorage.getItem('study_done') || '[]');
        if(!done.includes(day.id)) { done.push(day.id); localStorage.setItem('study_done', JSON.stringify(done)); renderSidebar(); }
    }

    function speak(text) { const msg = new SpeechSynthesisUtterance(text); msg.lang = 'en-US'; speechSynthesis.speak(msg); }

    function startChallenge(btn, targetText) {
        if (isRecording) return; isRecording = true; btn.classList.add('recording'); btn.innerText = "ğŸ›‘ è©•åˆ†ä¸­...";
        let finalScore = "â­", recognizedText = "";
        if (Recognition) {
            const rec = new Recognition(); rec.lang = 'en-US';
            rec.onresult = e => { 
                recognizedText = e.results[0][0].transcript.toLowerCase(); 
                const target = targetText.toLowerCase().replace(/[.,!?]/g, '');
                if (recognizedText === target) finalScore = "â­â­â­â­â­ (Perfect!)";
                else if (target.includes(recognizedText)) finalScore = "â­â­â­ (Good)";
            };
            rec.start();
        }
        navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {
            const mediaRecorder = new MediaRecorder(stream); let chunks = [];
            mediaRecorder.ondataavailable = e => chunks.push(e.data);
            mediaRecorder.onstop = () => {
                const blob = new Blob(chunks, { type: 'audio/webm' }); saveRecord(blob, targetText, finalScore, recognizedText);
                isRecording = false; btn.classList.remove('recording'); btn.innerText = btn.classList.contains('btn-play') ? "ğŸ”Š" : "ğŸ¤ éŒ„éŸ³è©•åˆ†";
            };
            mediaRecorder.start(); setTimeout(() => mediaRecorder.stop(), 4000);
        });
    }

    function saveRecord(blob, label, score, transcript) {
        const reader = new FileReader(); reader.readAsDataURL(blob);
        reader.onloadend = () => {
            const tx = db.transaction(["recordings"], "readwrite");
            tx.objectStore("recordings").add({ label, score, transcript, data: reader.result, time: new Date().toLocaleString() });
            tx.oncomplete = () => loadHistory();
        };
    }

    function loadHistory() {
        if(!db) return; const list = document.getElementById('history-list'); list.innerHTML = '';
        db.transaction("recordings").objectStore("recordings").openCursor(null, "prev").onsuccess = e => {
            const cursor = e.target.result;
            if (cursor) {
                const div = document.createElement('div'); div.className = 'audio-item';
                div.innerHTML = `<div class="audio-info"><strong>${cursor.value.label}</strong> <span style="color:#ffca28">${cursor.value.score}</span><button class="btn-delete" onclick="deleteRecord(${cursor.value.id})">ğŸ—‘ï¸</button></div><audio controls src="${cursor.value.data}"></audio>`;
                list.appendChild(div); cursor.continue();
            }
        };
    }

    function deleteRecord(id) { if(confirm("åˆªé™¤ç´€éŒ„ï¼Ÿ")) { db.transaction(["recordings"], "readwrite").objectStore("recordings").delete(id).oncomplete = () => loadHistory(); } }

    function onYouTubeIframeAPIReady() { player = new YT.Player('player', { height: '100%', width: '100%', videoId: 'Gy60BqCnTG4', events: { 'onReady': renderSidebar } }); }
</script>
</body>
</html>
